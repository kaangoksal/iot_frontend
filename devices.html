<!DOCTYPE html>
<html lang="en">
<head>
    <title>Devices</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/maps/documentation/javascript/demos/demos.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.4.5/css/mdb.min.css"/>
    <link rel="stylesheet" href="./css/project_specific.css">

    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.4.5/js/mdb.min.js"></script>


    <style>
        /* Set black background color, white text and some padding */
        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }

        #map {
            height: 400px;
            width: 100%;
        }

        .panel-default {
            margin-left: 0.5%;
            margin-right: 0.5%;
        }

        .well {
            margin-left: 0.5%;
            margin-right: 0.5%;
            margin-top: 0.5%;
            margin-bottom: 0.5%;
        }

        .glyphicon-device-status {
            font-size: 30px;
            color: green;
        }


    </style>
</head>
<body>


<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <!--<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">-->
            <!--<span class="icon-bar"></span>-->
            <!--<span class="icon-bar"></span>-->
            <!--<span class="icon-bar"></span>-->
            <!--</button>-->
            <a class="navbar-brand" href="#">Ginger Works Hermes</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav">
                <li><a href="dashboard.html">Dashboard</a></li>
                <li class="active"><a href="#">Devices</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="#"><span class="glyphicon glyphicon-menu-hamburger"></span> Settings</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid text-center">
    <div class="row">
        <div class="col-sm-2 panel panel-default">

            <div class="row panel-heading">
                <h4>Devices</h4>
            </div>
            <div class="panel-body">

                <div class="row" id="devices_panel">


                    <!--<div class="panel panel-default">-->
                    <!--<div class="panel-heading">-->
                    <!--<h4>GPS Tracker 1</h4>-->
                    <!--</div>-->
                    <!--<div class="panel-body">-->
                    <!--<div class="col-sm-3">-->
                    <!--<img src="images/gpstracker.png" class="img-circle" height="55" width="55" alt="Avatar">-->
                    <!--</div>-->
                    <!--<div class="col-sm-9">-->
                    <!--<div class="row">-->

                    <!--<p align="left">-->
                    <!--<span class="glyphicon glyphicon-flash glyphicon-device-status"></span>-->
                    <!--8 Hours of-->
                    <!--Battery available </p>-->

                    <!--</div>-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-ok-sign glyphicon-device-status"></span> All-->
                    <!--Systems Operational </p>-->

                    <!--</div>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->

                </div>
            </div>


        </div>
        <div class="col-md-9 panel panel-default">
            <div class="row panel-heading">
                <h4>Device Details</h4>
            </div>
            <div class="panel-body">

                <ul class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#dashboard_tab">Dashboard</a></li>
                    <li id="location_tab_box"><a data-toggle="tab" href="#location_tab">Location</a></li>
                    <li id="battery_tab_box"><a data-toggle="tab" href="#battery_tab">Battery</a></li>
                    <li id="raw_data_tab_box"><a data-toggle="tab" href="#raw_data_tab">Raw Data</a></li>
                    <li id="plug_state_tab_box"><a data-toggle="tab" href="#plug_state_tab">Plug State</a></li>
                </ul>

                <div class="tab-content">
                    <div id="dashboard_tab" class="tab-pane fade in active">
                        <div class="well col-sm-3">
                            <h4 align="left">Device Information</h4>

                            <div class="panel-default panel">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Device Username</p>
                                        </div>
                                        <div class="col-sm-9">
                                            <p id="device_username_text"> No device selected</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Device Name</p>
                                        </div>
                                        <div class="col-sm-9">
                                            <p id="device_name_text"> - </p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Latest Ping</p>
                                        </div>
                                        <div class="col-sm-9">
                                            <p id="latest_ping_text"> - </p>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="location_tab" class="tab-pane fade">
                        <div class="well col-sm-7">

                            <div id="map"></div>
                        </div>
                        <div class="well col-sm-4" id="device_location_well">
                            <h4 align="left">Location</h4>

                            <div class="panel-default panel">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Current Coordinates</p>
                                        </div>
                                        <div class="col-sm-9" >
                                            <p id="current_coordinates_text"> - </p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Current Location</p>
                                        </div>
                                        <div class="col-sm-9">
                                            <p id="current_location_text"> - </p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <p align="left">Latest Update</p>
                                        </div>
                                        <div class="col-sm-9">
                                            <p id="latest_update_text"> - </p>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="panel-default panel">
                                <div class="panel-body">
                                    <div class="col-sm-4">

                                        <p align="left">Start Date</p>

                                        <input type="date" name="start" id="trail-start-date">


                                    </div>
                                    <div class="col-sm-4">

                                        <p align="left">End Date</p>

                                        <input type="date" name="end" id="trail-end-date">


                                    </div>
                                    <div class="col-sm-3">
                                        <button type="button" class="btn btn-primary"
                                                onclick="return map_get_button();">Set
                                            Time Range
                                        </button>
                                    </div>

                                    <script>
                                        console.log("Initializing date for... ");
                                        var current = new Date();
                                        var before = new Date(current.getTime() - 86400000);
                                        var followingDay = new Date(current.getTime() + 86400000);
                                        var trail_start_date_picker = document.getElementById("trail-start-date");
                                        var trail_end_date_picker = document.getElementById("trail-end-date");


                                        var before_string = before.toISOString();
                                        before_string = before_string.slice(0, before_string.indexOf("T"));
                                        trail_start_date_picker.value = before_string;

                                        var following_day_string = followingDay.toISOString();
                                        following_day_string = following_day_string.slice(0, following_day_string.indexOf("T"));

                                        trail_end_date_picker.value = following_day_string; //fucking format is wrong, it has to be year-month-day

                                    </script>

                                </div>
                            </div>


                        </div>
                    </div>
                    <div id="battery_tab" class="tab-pane fade">


                        <div class="panel-default panel">
                            <div class="panel-body">
                                <div class="col-sm-4">

                                    <p align="left">Start Date</p>

                                    <input type="date" name="start">


                                </div>
                                <div class="col-sm-4">

                                    <p align="left">End Date</p>

                                    <input type="date" name="end">


                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary">Set Time Range</button>
                                </div>

                            </div>
                        </div>

                        <canvas id="lineChart_percentage"></canvas>


                    </div>
                    <div id="raw_data_tab" class="tab-pane fade">
                        <div class="row">
                            <div class="col-sm-5 text-left">
                                <input type="number" id="raw_data_page"/>
                                <!--<ul class="pagination" id="raw-data-pagination">-->
                                    <!--<li><a href="#">1</a></li>-->
                                    <!--<li class="active"><a href="#">2</a></li>-->
                                    <!--<li><a href="#">3</a></li>-->
                                    <!--<li><a href="#">4</a></li>-->
                                    <!--<li><a href="#">5</a></li>-->
                                <!--</ul>-->
                            </div>
                            <div class="col-sm-5">
                                <div class="panel-default panel">
                                    <div class="panel-body">
                                        <div class="col-sm-4">

                                            <p align="left">Start Date</p>

                                            <input type="date" name="start" id="raw_data-start-date">


                                        </div>
                                        <div class="col-sm-4">

                                            <p align="left">End Date</p>

                                            <input type="date" name="end" id="raw_data-end-date">


                                        </div>
                                        <div class="col-sm-3">
                                            <button type="button" class="btn btn-primary"
                                                    onclick="return get_raw_data();">Query
                                            </button>
                                        </div>

                                        <script>
                                            console.log("Initializing date for... ");
                                            var current = new Date();
                                            var before = new Date(current.getTime() - 86400000);
                                            var followingDay = new Date(current.getTime() + 86400000);
                                            var start_date_picker = document.getElementById("raw_data-start-date");
                                            var end_date_picker = document.getElementById("raw_data-end-date");


                                            var before_string = before.toISOString();
                                            before_string = before_string.slice(0, before_string.indexOf("T"));
                                            start_date_picker.value = before_string;

                                            var following_day_string = followingDay.toISOString();
                                            following_day_string = following_day_string.slice(0, following_day_string.indexOf("T"));

                                            end_date_picker.value = following_day_string; //fucking format is wrong, it has to be year-month-day

                                        </script>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="list-group" id="raw_data_list">
                            <!--<a data-toggle="collapse" href="#collapse1" class="list-group-item">-->
                                <!--<p class="list-group-item-text">Packet Id: 121,  Server Received at: 23 Feb 2018, Device Id: device1</p>-->
                                <!--<div class="panel-collapse panel-body collapse" id="collapse1">"{\n    \"BP\": 97,\n    \"BV\": 4.18,\n    \"D\": 24,\n    \"GL\": \"0,28.696495,41.057480,2018/02/24,23:23:28\",\n    \"H\": 23,\n    \"IMEI\": \"865067026137375\",\n    \"IP\": \"10.13.146.0\",\n    \"M\": 2,\n    \"Opr\": \"TELSIM GSM\",\n    \"S\": 28,\n    \"SigQty\": 29,\n    \"SimCCID\": \"8990029300776219052f\",\n    \"Y\": 2018,\n    \"a\": 35,\n    \"access_points\": [\n        {\n            \"bssid\": \"e0:3f:49:a9:6a:58:52:49\",\n            \"signal\": \"-83\"\n        },\n        {\n            \"bssid\": \"e8:94:f6:b4:8d:32:52:49\",\n            \"signal\": \"-62\"\n        }\n    ],\n    \"current\": 0.05,\n    \"la\": 41.0604705811,\n    \"lo\": 28.6959209442,\n    \"m\": 23,\n    \"mpt\": 38.37,\n    \"s\": 0.02,\n    \"sts\": \"Ltimeout\",\n    \"u\": 9,\n    \"v\": 9\n}"</div>-->
                            <!--</a>-->
                            <!--<a data-toggle="collapse" href="#collapse2" class="list-group-item">-->
                                <!--<p class="list-group-item-text">List Group Item Text</p>-->
                                <!--<div class="panel-collapse panel-body collapse" id="collapse2">Panel Body</div>-->
                            <!--</a>-->

                        </div>


                    </div>
                    <div id="plug_state_tab" class="tab-pane fade">
                        <h3>Plug State</h3>

                        <div class="panel-default panel">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p align="left">Current State</p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p> - </p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p align="left">Latest Update</p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p> - </p>
                                    </div>
                                </div>

                                <div class="btn-group">
                                    <button type="button" class="btn btn-success" onclick="return toggle_plug(1);">On</button>
                                    <button type="button" class="btn btn-danger" onclick="return toggle_plug(0);">Off</button>
                                </div>

                            </div>
                        </div>


                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<!--<footer class="container-fluid text-center">-->
    <!--<p>Footer Text</p>-->
<!--</footer>-->


<script src="js/devices_page_functions.js"></script>


<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVYK3iQrTq30MLqLO2j7YBqUM36S8Nm9Y&callback=initMap"></script>


</body>
</html>
