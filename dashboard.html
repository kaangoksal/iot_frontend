<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/maps/documentation/javascript/demos/demos.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.4.5/css/mdb.min.css"/>

    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.4.5/js/mdb.min.js"></script>

    <style>
        /* Set black background color, white text and some padding */
        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }

        #map {
            height: 400px;
            width: 100%;
        }

        .panel-default {
            margin-left: 1%;
            margin-right: 1%;
        }

        .glyphicon-device-status {
            font-size: 30px;
            color: green;
        }

    </style>
</head>
<body>


<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <!--<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">-->
            <!--<span class="icon-bar"></span>-->
            <!--<span class="icon-bar"></span>-->
            <!--<span class="icon-bar"></span>-->
            <!--</button>-->
            <a class="navbar-brand" href="#">Ginger Works Hermes</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#">Messages</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="#"><span class="glyphicon glyphicon-user"></span> Settings</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid text-center">
    <div class="row">
        <div class="col-sm-2 panel panel-default">
            <div class="row panel-heading">
                <h3>Events</h3>
            </div>
            <div class="panel-body">
                <div class="alert alert-success fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
                    <p><strong>Connection Restored</strong></p>
                    People are looking at your profile. Find out who.
                </div>

                <div class="alert alert-warning fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
                    <p><strong>Connection Lost</strong></p>
                    Connection lost with: Rover-1
                </div>
            </div>

        </div>
        <div class="col-sm-4 panel panel-default">

            <div class="row panel-heading">
                <h3>Devices</h3>
            </div>
            <div class="panel-body">

                <div class="row" id="devices_panel">


                    <!--<div class="panel panel-default">-->
                    <!--<div class="panel-heading">-->
                    <!--<h4>GPS Tracker 1</h4>-->
                    <!--</div>-->
                    <!--<div class="panel-body">-->
                    <!--<div class="col-sm-3">-->
                    <!--<img src="images/gpstracker.png" class="img-circle" height="55" width="55" alt="Avatar">-->
                    <!--</div>-->
                    <!--<div class="col-sm-9">-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-flash glyphicon-device-status"></span> 8 Hours of-->
                    <!--Battery available </p>-->

                    <!--</div>-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-ok-sign glyphicon-device-status"></span> All-->
                    <!--Systems Operational </p>-->

                    <!--</div>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->

                    <!--<div class="panel panel-default">-->
                    <!--<div class="panel-heading">-->
                    <!--<h4>GPS Tracker </h4>-->
                    <!--</div>-->
                    <!--<div class="panel-body">-->
                    <!--<div class="col-sm-3">-->
                    <!--<img src="images/gpstracker.png" class="img-circle" height="55" width="55" alt="Avatar">-->
                    <!--</div>-->
                    <!--<div class="col-sm-9">-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-flash glyphicon-device-status"></span> 8 Hours of-->
                    <!--Battery available </p>-->

                    <!--</div>-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-ok-sign glyphicon-device-status"></span> All-->
                    <!--Systems Operational </p>-->

                    <!--</div>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->

                    <!--<div class="panel panel-default">-->
                    <!--<div class="panel-heading">-->
                    <!--<h4>GPS Tracker 1</h4>-->
                    <!--</div>-->
                    <!--<div class="panel-body">-->
                    <!--<div class="col-sm-3">-->
                    <!--<img src="images/gpstracker.png" class="img-circle" height="55" width="55" alt="Avatar">-->
                    <!--</div>-->
                    <!--<div class="col-sm-9">-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-flash glyphicon-device-status"></span> 8 Hours of-->
                    <!--Battery available </p>-->

                    <!--</div>-->
                    <!--<div class="row">-->
                    <!--<p align="left"><span-->
                    <!--class="glyphicon glyphicon-ok-sign glyphicon-device-status"></span> All-->
                    <!--Systems Operational </p>-->

                    <!--</div>-->

                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>GPS Tracker 1</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-sm-3">
                                <img src="images/gpstracker.png" class="img-circle" height="55" width="55" alt="Avatar">
                            </div>
                            <div class="col-sm-9">
                                <div class="row">

                                    <p align="left">
                                        <span class="glyphicon glyphicon-flash glyphicon-device-status"></span>
                                         8 Hours of
                                        Battery available </p>

                                </div>
                                <div class="row">
                                    <p align="left"><span
                                            class="glyphicon glyphicon-ok-sign glyphicon-device-status"></span> All
                                        Systems Operational </p>

                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>


        </div>
        <div class="col-sm-5 panel panel-default">
            <div class="row panel-heading">
                <h3>Device Details</h3>
            </div>
            <div class="panel-body">

                <div class="well">
                    <h3 align="left">Device Information</h3>

                    <div class="panel-default panel">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Device Username</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>0013123asdf</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Device Name</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>Motorcycle Tracker</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Latest Ping</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>10 Minutes Ago</p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="well">
                    <h3 align="left">Location</h3>

                    <div class="panel-default panel">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Current Coordinates</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>28.696123, 41.057537</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Current Location</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>Istanbul, Bahcesehir</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <p align="left">Latest Update</p>
                                </div>
                                <div class="col-sm-9">
                                    <p>10 Minutes Ago</p>
                                </div>
                            </div>

                        </div>
                    </div>


                    <div id="map"></div>

                </div>


                <div class="well">
                    <h3 align="left">Battery</h3>


                    <canvas id="lineChart"></canvas>

                    <script>

                        //line
                        var ctxL = document.getElementById("lineChart").getContext('2d');
                        var myLineChart = new Chart(ctxL, {
                            type: 'line',
                            data: {
                                labels: ["0", "1", "2", "3", "4", "5", "6"],
                                datasets: [
                                    {
                                        label: "Battery",
                                        fillColor: "rgba(220,220,220,0.2)",
                                        strokeColor: "rgba(220,220,220,1)",
                                        pointColor: "rgba(220,220,220,1)",
                                        pointStrokeColor: "#fff",
                                        pointHighlightFill: "#fff",
                                        pointHighlightStroke: "rgba(220,220,220,1)",
                                        data: [100, 95, 80, 81, 56, 55]
                                    }
                                ]
                            },
                            options: {
                                responsive: true
                            }
                        });

                    </script>


                </div>


            </div>

        </div>
    </div>
</div>

<footer class="container-fluid text-center">
    <p>Footer Text</p>
</footer>


<script>
    fill_devices_list();

    function fill_devices_list() {
        var authorization = "Basic" + " " + btoa("user-8252ce9c-5960-48a2-aecc-c17212240ffd" + ":" + "pass-kaan");
        var data = JSON.stringify(false);
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                console.log(" Response : " + xhttp.responseText);
                var json_response = JSON.parse(xhttp.responseText);
                var devices_array = json_response["devices"];
                var devices_panel_root = document.getElementById("devices_panel");

                for (var i = 0; i < devices_array.length; i++) {
                    // maybe declare these guys outside
                    var device_name = devices_array[i]["device_name"];
                    var device_last_ping = devices_array[i]["last_ping"];

                    var device_type = devices_array[i]["type"];

                    var device_id = devices_array[i]["device_id"];

                    var new_device_panel = document.createElement("div");
                    new_device_panel.className = "panel panel-default";

                    devices_panel_root.appendChild(new_device_panel);
                    //=======================Header==================================
                    var device_panel_header_div = document.createElement("div");
                    device_panel_header_div.className = "panel-heading";

                    new_device_panel.appendChild(device_panel_header_div);

                    var device_name_header = document.createElement("h4");
                    device_name_header.textContent = device_name;

                    device_panel_header_div.appendChild(device_name_header);
                    //======================BODY=======================================
                    var panel_body_div = document.createElement("div");
                    panel_body_div.className = "panel-body";

                    new_device_panel.appendChild(panel_body_div);
                    //=====================Image col==========================
                    var image_col = document.createElement("div");
                    image_col.className = "col-sm-3";

                    panel_body_div.appendChild(image_col);

                    var device_image = document.createElement("img");
                    device_image.src = "images/gpstracker.png";
                    device_image.className = "img-circle";
                    device_image.height = "55";
                    device_image.width = "55";
                    device_image.alt = "Avatar";

                    image_col.appendChild(device_image);
                    //==================info col==============================
                    var info_col = document.createElement("div");
                    info_col.className = "col-sm-9";

                    panel_body_div.appendChild(info_col);

                    //=============row in info col===============
                    var row_battery = document.createElement("div");
                    row_battery.className = "row";

                    info_col.appendChild(row_battery);

                    // battery status

                    var p_battery = document.createElement("p");
                    p_battery.align = "left";

                    row_battery.appendChild(p_battery);

                    var glyphicon_battery = document.createElement("span");
                    glyphicon_battery.className = "glyphicon glyphicon-flash glyphicon-device-status";
                    p_battery.appendChild(glyphicon_battery);

                    p_battery.textContent = "8 hours of battery available";

                    //=============row in info col===============
                    var row_status = document.createElement("div");
                    row_status.className = "row";

                    info_col.appendChild(row_status);

                    // system status

                    var p_status = document.createElement("p");
                    p_status.align = "left";

                    row_status.appendChild(p_status);

                    var glyphicon_status = document.createElement("span");
                    glyphicon_status.className = "glyphicon glyphicon-ok-sign glyphicon-device-status";
                    p_status.appendChild(glyphicon_status);

                    p_status.textContent = "All Systems online";


                }

            }
        };
        xhttp.open("POST", "http://kaangoksal.com:5001/get_user_devices", true);
        xhttp.setRequestHeader("Content-type", "application/json");
        xhttp.setRequestHeader("Authorization", authorization);
        xhttp.send(data);
        console.log("Sent get_user_devices Request");

    }


</script>


<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVYK3iQrTq30MLqLO2j7YBqUM36S8Nm9Y&callback=initMap"></script>
<script>

    function initMap() {
        console.log("I got called");
        var uluru = {lat: -25.363, lng: 131.044};
        map = new google.maps.Map(document.getElementById('map'), {zoom: 4, center: uluru});
        //var marker = new google.maps.Marker({position: uluru, map: map});

    }
</script>

<script>
    function change_map() {
        var myLatlng = new google.maps.LatLng(41.057537, 28.696123);
        var mapOptions = {
            zoom: 4,
            center: myLatlng
        };
        var map = new google.maps.Map(document.getElementById("map"), mapOptions);

        var marker = new google.maps.Marker({
            position: myLatlng,
            title: "Hello World!"
        });

        // To add the marker to the map, call setMap();
        marker.setMap(map);


        // console.log("I also got called, will change the map");
        // initMap();
        // var uluru = {lat: 41.057537, lng: 28.696123};
        // var marker = new google.maps.Marker({position: uluru, map: map});
        // // initMap();

    }

    function add_path(waypoints) {
        // var flightPlanCoordinates = [
        //     {lat: 37.772, lng: -122.214},
        //     {lat: 21.291, lng: -157.821},
        //     {lat: -18.142, lng: 178.431},
        //     {lat: -27.467, lng: 153.027}
        // ];
        var path = new google.maps.Polyline({
            path: waypoints,
            geodesic: true,
            strokeColor: '#FF0000',
            strokeOpacity: 1.0,
            strokeWeight: 2
        });

        path.setMap(map);

    }
</script>

</body>
</html>
